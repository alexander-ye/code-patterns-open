---
problem_number: 74
title: Search a 2D Matrix
src:
  {
    domain: LeetCode,
    url: https://leetcode.com/problems/search-a-2d-matrix/,
    difficulty: "Medium",
  }
languages: [Python]
author: Alex Ye
---

import CodeTabs from "@components/content/codetabs/CodeTabs.tsx";

## Problem Statement

<blockquote src={frontmatter.src_url}>

You are given an `m x n` integer matrix `matrix` with the following two properties:

- Each row is sorted in non-decreasing order.
- The first integer of each row is greater than the last integer of the previous row.

Given an integer `target`, return `true` if target is in `matrix` or `false` otherwise.

You must write a solution in `O(log(m * n))` time complexity.

**Constraints**

- `m == matrix.length`
- `n == matrix[i].length`
- `1 <= m, n <= 100`
- <code>
    -10<sup>4</sup> {"<="} matrix[i][j] {"<="} 10<sup>4</sup>
  </code>

<details>
<summary><strong>Example Test Cases</strong></summary>

**Example 1:**

```
Input: matrix = [[1,3,5,7],[10,11,16,20],[23,30,34,60]], target = 3
Output: true
```

**Example 2:**

```
Input: matrix = [[1,3,5,7],[10,11,16,20],[23,30,34,60]], target = 13
Output: false
```

</details>
</blockquote>

## Understanding the Problem
### Inputs
Our function takes in two arguments:

- `matrix`, which is a matrix represented by a list of lists of integers.
- `target`, an integer that may or may not be an element in `matrix`

### Outputs

Our function should return a boolean: 

- `true` if `target` is in `matrix`
- `false` if target is not in `matrix`

## Solution

To solve this problem, we employ binary search.

<CodeTabs>

```python
class Solution:
  def searchMatrix(self, matrix: List[List[int]], target: int) -> bool:
    # Binary search on the rows
    top = 0
    bot = len(matrix) - 1

    while top <= bot:
      mid = (top + bot) // 2
      # Take advantage of the linear sorting with an early break
      if matrix[mid][0] < target and matrix[mid][-1] > target:
        break
      elif matrix[mid][0] > target:
        bot = mid - 1
      else:
        top = mid + 1
    
    # The row we want to binary search columns for
    row = (top + bot) // 2

    # Binary search on the columns (standard binary search for array function)
    left = 0
    right = len(matrix[row]) - 1

    while left <= right:
      mid = (left + right) // 2

      if matrix[row][mid] == target:
        return True
      elif matrix[row][mid] > target:
        right = mid - 1
      else:
        left = mid + 1
    
    return False
```

</CodeTabs>

The runtime of this solution is `O(log(m) + log(n))`, or equivalently, `O(log(m * n))`.
